# chapter Appendix A

Goのエコシステムには、潤沢にツールが提供されている。開発のどの段階でどのように助けになるかを紹介する。

## A.1 ゴルーチンのエラーの解剖

panicが起きたときに表示されるものはバージョンによって違う(環境変数`GOTRACEBACK`を`all`にしたら1.6以前の表示になる)：

- Go1.6以前は現在実行中のゴルーチンの全部のスタックトレースを表示する。
- Go1.6以降はパニックしたゴルーチンのスタックトレースだけ

スタックトレースに表示されるもの：

1. パニックが発生した場所の参照
2. ゴルーチンが起動した場所の参照
3. ゴルーチンとして実行している関数の名前の表示(無名関数だったら自動に決められた一意の識別子)

## A.2 競合状態の検出

Go1.1で、ほぼすべてのgoコマンドに `-race`フラグが追加。

raceフラグは競合状態検出器であり、実行されたコード内に含まれる競合状態のみを検出する。

→　Goチームの推奨:raceフラグ付きでビルドしたアプリケーションを実世界の負荷で実行すること。(これによって多くのコードが実行される確率が上がり、競合状態を発見する確率が上がる)

競合状態検出器の動作を変えるための、環境変数経由で設定できる項目：

- `LOG_PATH`: レポートの書き込み先を "LOG_PATH.pid"に指定するオプション。stdout と stderr も設定可能。
- `STRIP_PATH_PREFIX`: レポート内に書かれるファイルパスの初めの部分を削り、レポートをより簡潔にできるオプション。
- `HISTORY_SIZE`: ゴルーチンごとの履歴の大きさを指定するオプション。レポートで"failed to restore the stack"と表示されるときに使おう。
有効値は0から7まで。履歴用に確保されるメモリは32KBから4MB。

継続的インテグレーションの処理の一部として組み込みことが強く勧められる。
3章で述べた通り、発現が難しい場合があるので、実環境のシナリオで実行して競合状態を見つけるべき。

## A.3 pprof

## A.4 trace(日本語版オリジナル)
